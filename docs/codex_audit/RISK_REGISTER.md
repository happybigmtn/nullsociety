| ID | Severity | Area | Finding | Evidence (paths) | Impact | Likelihood | Recommendation | Effort | Dependencies |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| RR-1 | P0 | Build/Test | Workspace tests fail to compile after config changes (missing `mempool_stream_buffer_size` and nonce cache fields in `nullspace-node` tests). | `node/src/tests.rs` lines 44-85, 259-270, 504-511, 623-632, 787-794, 1021-1028; `cargo test --locked --workspace --all-targets --no-run` | Blocks CI and any release artifact; prevents regression coverage for node code. | High (reproducible locally) | Update test fixtures to include the new config fields or add defaults to builders; re-run workspace tests. | S | None |
| RR-2 | P0 | Security | Secrets and private keys committed to repo, including Convex service token, Stripe secrets, and validator private keys/identities. | `docker/convex/.env` lines 1-4; `configs/local/node*.yaml` lines 1-33; `configs/local/.env.local` lines 1-3 | Credential leakage risk (service token and Stripe keys usable against any running Convex instance); private keys can be used to impersonate validators or clients. | High | Remove committed secrets, rotate all exposed keys, and replace with templates (`.env.example`); add secret scanning to CI. | M | Requires key rotation with providers (Convex/Stripe) |
| RR-3 | P1 | Security/Reliability | Simulator HTTP/WS API is unauthenticated and rate limiting is disabled by default; Quickstart enables `ALLOW_HTTP_NO_ORIGIN=1` allowing requests without Origin header. | `simulator/src/api/mod.rs` lines 38-152; `quickstart.md` lines 41-75 | Public exposure allows untrusted clients to flood `/submit`/WS endpoints, drive resource exhaustion, or spam mempool. | Medium-High | Require auth (API token or mTLS) or restrict network exposure; enable mandatory origin allowlist and non-zero rate limits in production configs; add default sane limits. | M | Depends on chosen auth mechanism and gateway changes |
| RR-4 | P1 | Security/Architecture | Gateway WebSocket server auto-generates wallets and registers/deposits chips for any connecting client with no authentication or transport security. | `gateway/src/index.ts` lines 9-88; `gateway/src/session/manager.ts` lines 23-111 | If exposed beyond trusted network, attackers can create unbounded sessions/transactions, amplifying load on simulator and exhausting balances. | Medium | Gate gateway behind auth/TLS, enforce connection limits and per-IP/session quotas, and disable auto-registration in production. | M | Coordination with simulator auth/nonce handling |
| RR-5 | P2 | Data Durability | Explorer persistence defaults to in-memory; optional SQLite/Postgres not validated at startup and retention limits can be zero (disabled). | `simulator/src/main.rs` args 24-85; `docs/persistence.md` | Production restarts would drop explorer history and WS consumers could see data gaps; scaling to multiple replicas without shared DB will diverge. | Medium | Make Postgres/Snapshot storage mandatory in production configs; add startup validation and runbook for migrations/backups. | M | Requires DB provisioning and migration tooling |
